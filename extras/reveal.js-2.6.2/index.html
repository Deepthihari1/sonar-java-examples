<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">

<title>Architekturforum: Einsatz von Sonar zur Kontrolle der
	Architektur</title>

<meta name="description"
	content="Einsatz von sonar zur Kontrolle der Architektur">
<meta name="author" content="Derrick Fiedler">
<meta name="author" content="Dimitrij Pinneker">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style"
	content="black-translucent" />

<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<link rel="stylesheet" href="css/reveal.min.css">
<link rel="stylesheet" href="css/theme/serif.css" id="theme">


<!-- For syntax highlighting -->
<link rel="stylesheet" href="lib/css/zenburn.css">

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
	if (window.location.search.match(/print-pdf/gi)) {
		var link = document.createElement('link');
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = 'css/print/pdf.css';
		document.getElementsByTagName('head')[0].appendChild(link);
	}
</script>

<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
</head>

<body>

	<div class="reveal">

		<!-- Any section element inside of this container is displayed as a slide -->
		<div class="slides">
			<section>
				<h3>Einsatz von Sonar</h3>
				<h4>zur Absicherung von Architekturregeln</h4>

				<!-- Startbild -->
				<img style="width:80%; border: none;" alt="sonar" src="../../presentation/images/sonar.jpg">
				<p>
					<small>präsentiert von </small> <br> <small>Dimitrij
						Pinneker & Derrick Fiedler </small>
				</p>
			</section>

			<section>
				<h3>Ist-Zustand</h3>
				<ul>
					<li>Nächtliche Analyse</li>
					<li>Kein direkter Feedback bei Regelverletzungen</li>
					<li>Sammlung von Regelverletzungen
						<ul>
							<li>Duplications</li>
							<li>Coding Standards</li>
							<li>Lack of Coverage</li>
							<li>Potential bugs</li>
							<li>Complexity</li>
							<li>Documentation</li>
							<li>Design</li>
						</ul>
					</li>
				</ul>
			</section>

			<section>
				<h3>Soll-Zustand</h3>
				<ul>
					<li>Besserer Code in Versionsverwaltung</li>
					<li>Keine neue Regelverletzungen</li>
					<li>Frühzeitger Feedback bei Regelverletzungen</li>
					<li>Lokale Prüfung der geänderten Quellcode gegen aktive Regeln</li>
				</ul>
			</section>

			<section>
				<h3>... Und was ist der Zweck ?</h3>
				<div>
					<img style="width:100%; border: none;" alt="code-quality" 
						 src="../../presentation/images/code-quality-02.png">
				</div>
			</section>
			
			<section>
				<h3>... Und was ist der Zweck ?</h3>
				<ul>
					<li>Qualität der Quellcode erhöhen</li>	
				</ul>
			</section>
			
			<!-- Vorstellung Sonar -->
			<section>
				<h3>Agenda</h3>
				<ul>
					<li>Vorstellung SonarQube</li>
					<li>Nutzung auf dem CI-System</li>
					<li>Nutzung von SonarQube</li>
					<li>Vorführung</li>
				</ul>
			</section>

			<!-- Vorstellung Sonar -->
			<section>
				<section>
					<h3>SonarQube ist</h3>
					<ul>
					<li>Werkzeug für statische Codeanalyse</li>
					<li>Mit Datenbank für frühere Ergebnisse</li>
                                        <li>Reviewwerkzeug</li>
					</ul>
				</section>
				<section>
					<h3>Regeln / Metriken</h3>
                                        <ul>
						<li>Größen</li>
						<li>Doppelter Code</li>
						<li>Ungenutzter Code</li>
						<li>Testergebnisse</li>
						<li>Komplexität</li>
						<li>Checkstyle, Findbugs, PMD</li>
						<li>Designregeln</li>
						<li>Sonarspezifische Regeln</li>
					</ul>
				</section>
				<section>
					<h3>Qualitätsprofile</h3>
                                        <ul>
						<li>Fassen aktive Regeln zusammen</li>
						<li>können von anderen Profile erben</li>
					</ul>
				</section>
				<section>
					<h3>Quality gates</h3>
                                        <ul>
						<li>Fassen Grenzwerte zusammen</li>
						<li>Bieten Vergleich mit < > = und ! </li>
					</ul>
				</section>
				<section>
					<h3>Vorstellung SonarQube</h3>
					<h3>
						<small><a href="#">Durchführung...</a></small>
					</h3>
				</section>
			</section>

			<!-- Nutzung auf dem CI-System -->
			<section>
				<section>
					<h3>Nutzung auf dem CI-System</h3>
                                        <ul>
					<li>Sonarqube-Plugin</li>
					<li>Mit Buildbreaker-Plugin in Sonarqube</li>
                                        </ul>
				</section>
				<section>
					<h3>Möglichkeiten der Analyse mit CI</h3>
					<ul>
						<li>Nightly check</li>
						<li>Code Analyse bei jedem Push</li>
						<li>Zusammen mit Gerrit für pre-commit-checks</li>
					</ul>
				</section>
				<section>
					<h3>Nutzung auf dem CI-System</h3>
					<h3>
						<small><a href="#">Durchführung...</a></small>
					</h3>
				</section>
			</section>

			<!-- Nutzung von SonarQube -->
			<section>
				<section>
					<h3>Nutzung von SonarQube</h3>
					<div>
						<img style="width:100%; border: none;" alt="techical-architecture" 
							 src="../../presentation/images/technical-architecture.jpeg">
					</div>
				</section>
				<section>
					<h3>Nutzung von SonarQube</h3>
					<ul>
						<li>SonarQube Runner</li>
						<li>Maven</li>
						<li>SonarQube Ant Task</li>
						<li>Gradle</li>
						<li>CI Engine</li>
					</ul>
				</section>

				<!-- SonarQube Runner -->
				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>SonarQube Runner</h4>
					<ul>
						<li>Default Programm zur Analyse von Projekten</li>
						<li>Letzte Vesion: 2.4</li>
						<li>Voraussetzung
							<ul>
								<li>Java 6 oder &ge;</li>
								<li>SonarQube Version &ge; 3.7</li>
							</ul>
						</li>
						<li>Einstellung via sonar-runner.properties</li>
						<li>sonar-project.properties in Projekt</li>
						<li><b>sonar-runner</b> ausführen</li>
					</ul>
				</section>

				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>Maven</h4>
					<ul>
						<li>Empfohlen für Maven Projekte</li>
						<li>Voraussetzung <br /> <small>
								<ul>
									<li>Maven <i>(<a target="_blank"
											href="http://docs.codehaus.org/display/SONAR/Analyzing+Source+Code#AnalyzingSourceCode-CompatibilityMatrix">
												Kompatibilitätsprüfung</a>)
									</i></li>
								</ul>
						</small>
						</li>
						<li>Einstellung via settings.xml/ POM.xml</li>
					</ul>
				</section>

				<section data-state="customevent">
					<h3>Nutzung von SonarQube</h3>
					<h4>Maven</h4>
					<b>POM.xml</b>
					<pre>
						<code data-trim contenteditable style="font-size: 18px;">
							<?xml version="1.0" encoding="UTF-8"?>
							<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
							  <modelVersion>4.0.0</modelVersion>
							
							  <groupId>org.example</groupId>
							  <artifactId>sonar-maven-example</artifactId>
							  <version>1.0-SNAPSHOT</version>
							
							  <name>Simple Java Maven Project</name>
							
							  <properties>
							    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
							    <sonar.language>java</sonar.language>
							    <sonar.host.url>http://localhost:9000</sonar.host.url>
							    <sonar.branch>x</sonar.branch>
							  </properties>
							</project>
						</code>
					</pre>
				</section>

				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>Maven</h4>
					<ul>
						<li>mvn clean install</li>
						<li>mv sonar:sonar ausführen</li>
					</ul>
				</section>

				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>SonarQube Ant Task</h4>
					<ul>
						<li>Empfohlen für Ant Projekte</li>
						<li>Letzte Vesion: 2.1</li>
						<li>Voraussetzung
							<ul>
								<li>Java 6 oder &ge;</li>
								<li>SonarQube Version &ge; 3.0</li>
								<li>Ant 1.7.1 or &ge;</li>
								<li><i>(<a target="_blank"
										href="http://docs.codehaus.org/display/SONAR/Analyzing+Source+Code#AnalyzingSourceCode-CompatibilityMatrix">
											Kompatibilitätsprüfung</a>)
								</i></li>
							</ul>
						</li>
						<li>Integration der SonarQube Analyse in ein Ant build skript</li>
					</ul>
				</section>

				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>SonarQube Ant Task</h4>
					<b>Definition eines Sonar Ant Target</b>
					<pre>
						<code data-trim contenteditable style="font-size: 18px;">
							<project name="My Project" default="all" basedir="."
								xmlns:sonar="antlib:org.sonar.ant">
								<!-- Define the SonarQube global properties (the most usual way is to pass these properties via the command line) -->
								<property name="sonar.jdbc.url" value="jdbc:mysql://localhost:3306/sonar?useUnicode=true&amp;characterEncoding=utf8" />
								<property name="sonar.jdbc.username" value="sonar" />
								<property name="sonar.jdbc.password" value="sonar" />
								<!-- Define the SonarQube project properties -->
								<property name="sonar.projectKey" value="org.codehaus.sonar:example-java-ant" />
								<property name="sonar.projectName" value="Simple Java Project analyzed with the SonarQube Ant Task" />
								<property name="sonar.projectVersion" value="1.0" />
								<property name="sonar.language" value="java" />
								<property name="sonar.sources" value="src" />
								<property name="sonar.binaries" value="build/*.jar" />
								<!-- Define the SonarQube target -->
								<target name="sonar">
								    <taskdef uri="antlib:org.sonar.ant" resource="org/sonar/ant/antlib.xml">
								        <!-- Update the following line, or put the "sonar-ant-task-*.jar" file in your "$HOME/.ant/lib" folder -->
								        <classpath path="path/to/sonar/ant/task/lib/sonar-ant-task-*.jar" />
								    </taskdef>
								 
								    <!-- Execute the SonarQube analysis -->
								    <sonar:sonar />
								</target>
						
						</code>
					</pre>
				</section>

				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>SonarQube Ant Task</h4>
					<ul>
						<li><b>ant sonar</b> ausführen</li>
					</ul>
				</section>

				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>Gradle</h4>
					<ul>
						<li>Empfohlen für Gradle Projekte</li>
						<li>Voraussetzung
							<ul>
								<li>Sonar Runner Plugin</li>
								<li>build.gradle <br/>
									<pre>
										<code data-trim contenteditable style="font-size: 18px;">
											apply plugin: "sonar-runner"
										</code>
									</pre>
								</li>
					    	</ul>
					    </li>
					    <li><b>gradle sonarRunner</b> ausführen</li>
					</ul>
				</section>
				
				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>Gradle</h4>
					<b>SonarRunner Konfiguration</b>
					<pre>
						<code data-trim contenteditable style="font-size: 18px;">
							sonarRunner {
							    sonarProperties {
							        property "sonar.host.url", "http://localhost:9000"
							        property "sonar.jdbc.url", "jdbc:mysql://localhost/sonar"
							        property "sonar.jdbc.driverClassName", "com.mysql.jdbc.Driver"
							        property "sonar.jdbc.username", "admin"
							        property "sonar.jdbc.password", "admin"
							    }
							}
						</code>
					</pre>					
				</section>

				<section>
					<h3>Nutzung von SonarQube</h3>
					<h4>CI Engine</h4>
					<ul>
						<li>Analyse durch CI Server
							<ul>
								<li>Jenkins Plugin</li>
								<li>Hudson Plugin</li>
								<li>TeamCity</li>
								<li>...</li>
							</ul>
						</li>
					</ul>
				</section>

				<section>
					<h3>SonarQube aus Eclipse</h3>
					<h4>Einstellung</h4>
					<ul>
						<li>SonarQube Plugin via <b>Eclipse Marketplace...</b></li>
						<li>Suche nach <b>SonarQube</b></li>
						<li>Installieren</li>
					</ul>
				</section>

				<section>
					<h3>SonarQube aus Eclipse</h3>
					<h4>Einstellung</h4>
					<img style="width:100%; border: none;" 
						 alt="sonar-preferences" 
						 src="../../presentation/images/sonarqube-config.1.png">
				</section>
				
				<section>
					<h3>SonarQube aus Eclipse</h3>
					<h4>Einstellung</h4>
					<div>
						<b>Verbindung zu Sonarqube Server</b>
						<img style="width:100%; border: none;" 
							 alt="sonar-preferences" 
							 src="../../presentation/images/sonarqube-config.2.png">
					</div>
				</section>
				
				<section>
					<h3>SonarQube aus Eclipse</h3>
					<h4>Einstellung</h4>
					<div>
						<b>Verbindung zu Sonarqube Server</b>
						<img style="width:100%; border: none;" 
							 alt="sonar-preferences" 
							 src="../../presentation/images/sonarqube-config.3.png">
					</div>
				</section>
				
				<section>
					<h3>SonarQube aus Eclipse</h3>
					<h4>Einstellung</h4>
					<div>
						<b>Einstellung des Analysenmodus</b>
						<img style="width:100%; border: none;" 
							 alt="sonar-preferences" 
							 src="../../presentation/images/sonarqube-config.4.png">
					</div>
				</section>
				
				<section>
					<h3>SonarQube aus Eclipse</h3>
					<h4>Einstellung</h4>
						<b>Einstellung des Analysenmodus</b> <br/>
						<ul>
							<li>sonar.analysis.mode
								<ul>
									<li>analysis</li>
									<li>preview</li>
									<li>incremental</li>
								</ul>
							</li>
						</ul>
				</section>
				
				<section>
					<h3>SonarQube aus Eclipse</h3>
					<h4>Einstellung</h4>
					<ul>
						<li>Assoziiere Java Projekt zu Sonarqube</li>
						<li>Analyse durchführen mit <b>Ctrl + Alt + Q</b></li>
					</ul>
					<div>
						<img style="width:80%;" alt="sonar-preferences" src="../../presentation/images/sonarqube-config.5.png">
					</div>
				</section>
				
				<section>
					<h3>SonarQube aus Eclipse</h3>
					<h3>
						<small><a href="#">Durchführung...</a></small>
					</h3>
				</section>
			</section>

			<section>
				<h3>Quelle</h3>
				<small>
					<ol>
						<li><a target="_blank" href="http://docs.codehaus.org/display/SONAR/Documentation">http://docs.codehaus.org/display/SONAR/Documentation</a></li>
						<li><a target="_blank" href="http://www.sonarqube.org/analysis-vs-preview-vs-incremental-preview-in-sonarqube/">http://www.sonarqube.org/analysis-vs-preview-vs-incremental-preview-in-sonarqube/</a></li>
						<li><a target="_blank" href="http://www.sonarqube.org/three-options-for-pre-commit-analysis/">http://www.sonarqube.org/three-options-for-pre-commit-analysis/</a></li>
						<li><a target="_blank" href="http://docs.codehaus.org/display/SONAR/Build+Breaker+Plugin">http://docs.codehaus.org/display/SONAR/Build+Breaker+Plugin</a></li>
						<li><a target="_blank" href="http://docs.codehaus.org/display/SONAR/Jenkins+Plugin">http://docs.codehaus.org/display/SONAR/Jenkins+Plugin</a></li>
						<li><a target="_blank" href="http://www.gradle.org/docs/current/userguide/sonar_runner_plugin.html">http://www.gradle.org/docs/current/userguide/sonar_runner_plugin.html</a></li>
						<li><a target="_blank" href="http://lab.hakim.se/reveal-js/#/">http://lab.hakim.se/reveal-js/#/</a></li>
						<li><a target="_blank" href="https://github.com/hakimel/reveal.js/">https://github.com/hakimel/reveal.js/</a></li>
					</ol>
				</small>
			</section>
			
			<section>
				<p>Danke für Ihre Aufmerksamkeit!</p>
				<p>Fragen?</p>
			</section>
			
			<section>
				<h3>Tipps</h3>
				<p>????</p>
			</section>
		</div>

	</div>

	<script src="lib/js/head.min.js"></script>
	<script src="js/reveal.min.js"></script>

	<script>
		// Full list of configuration options available here:
		// https://github.com/hakimel/reveal.js#configuration
		Reveal.initialize({
			controls : true,
			progress : true,
			history : true,
			center : true,

			theme : Reveal.getQueryHash().theme, // available themes are in /css/theme
			transition : Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

			// Parallax scrolling
			// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
			// parallaxBackgroundSize: '2100px 900px',

			// Optional libraries used to extend on reveal.js
			dependencies : [ {
				src : 'lib/js/classList.js',
				condition : function() {
					return !document.body.classList;
				}
			}, {
				src : 'plugin/markdown/marked.js',
				condition : function() {
					return !!document.querySelector('[data-markdown]');
				}
			}, {
				src : 'plugin/markdown/markdown.js',
				condition : function() {
					return !!document.querySelector('[data-markdown]');
				}
			}, {
				src : 'plugin/highlight/highlight.js',
				async : true,
				callback : function() {
					hljs.initHighlightingOnLoad();
				}
			}, {
				src : 'plugin/zoom-js/zoom.js',
				async : true,
				condition : function() {
					return !!document.body.classList;
				}
			}, {
				src : 'plugin/notes/notes.js',
				async : true,
				condition : function() {
					return !!document.body.classList;
				}
			} ]
		});
	</script>

</body>
</html>
